version: v1beta9
deployments:
  - name: nginx
    helm:
      chart:
        name: bitnami/nginx-ingress-controller
  - name: manifests
    kubectl:
      manifests:
        - secrets
  - name: mysql
    helm:
      chart:
        name: bitnami/mysql
      values:
        auth:
          existingSecret: credentials
          database: florian-db
          username: florian
        primary:
          service:
            clusterIP: 10.3.253.92
  - name: wordpress
    helm:
      chart:
        name: bitnami/wordpress
      values:
        wordpressEmail: wp@test.com
        wordpressUsername: wp
        existingSecret: credentials
        mariadb:
          enabled: false
        externalDatabase:
          host: 10.3.253.92
          user: florian
          existingSecret: credentials
          database: florian-db
          port: 3306
        autoscaling:
          minReplicas: 1
          maxReplicas: 1
        ingress:
          enabled: true
          hostname: wordpress.qaz.to
        service:
          type: ClusterIP

profiles:
- name: production
  replace:
    dependencies:
    - source:
        path: secrets/sealed-secrets-controller
      namespace: kube-system
