version: v1beta9
deployments:
  - name: manifests
    kubectl:
      manifests:
        - secrets
  - name: external-dns
    helm:
      chart:
        name: bitnami/external-dns
      values:
        logLevel: debug
        provider: cloudflare
        zoneIdFilters:
          - 4025071c033eda2d42ef9fc40865cff9
        cloudflare:
          secretName: external-dns
  - name: nginx
    helm:
      chart:
        name: bitnami/nginx-ingress-controller
      values:
        service:
          type: LoadBalancer
          loadBalancerIP: 35.247.82.139
          annotations:
            external-dns.alpha.kubernetes.io/hostname: nginx.qaz.to
  - name: mysql
    helm:
      chart:
        name: bitnami/mysql
      values:
        auth:
          existingSecret: credentials
          database: florian-db
          username: florian
        primary:
          service:
            clusterIP: 10.3.253.92
  - name: wordpress
    helm:
      chart:
        name: bitnami/wordpress
      values:
        wordpressEmail: wp@test.com
        wordpressUsername: wp
        existingSecret: credentials
        mariadb:
          enabled: false
        externalDatabase:
          host: 10.3.253.92
          user: florian
          existingSecret: credentials
          database: florian-db
          port: 3306
        autoscaling:
          minReplicas: 1
          maxReplicas: 1
        ingress:
          enabled: true
          hostname: wordpress
        service:
          type: ClusterIP
profiles:
- name: production
  replace:
    dependencies:
    - source:
        path: secrets/sealed-secrets-controller
      namespace: kube-system
